<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>McIndi WebUtils | McIndi Solutions</title>
    <style>

      :root {
        --bg: #f3f1ed;
        --ink: #111418;
        --muted: #626a73;
        --accent: #c6562a;
        --accent-dark: #a14320;
        --danger: #b9382e;
        --card: #fbf7f2;
        --stroke: #e2d8cf;
        --brand-deep: #0f1720;
        --brand-fade: rgba(15, 23, 32, 0.08);
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        color: var(--ink);
        background: radial-gradient(900px 600px at 10% -10%, #f6d9c4 0%, transparent 60%),
          radial-gradient(700px 500px at 120% 10%, #d4e9e5 0%, transparent 60%),
          var(--bg);
        font-family: "Manrope", "Segoe UI", "Helvetica Neue", Arial, sans-serif;
      }

      header {
        padding: 40px 24px 16px;
        max-width: 1100px;
        margin: 0 auto;
        display: flex;
        flex-direction: column;
        gap: 24px;
      }

      .brand-bar {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 16px;
        flex-wrap: wrap;
      }

      .brand-link {
        display: inline-flex;
        align-items: center;
        gap: 10px;
        text-decoration: none;
        color: var(--brand-deep);
        font-weight: 700;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        font-size: 0.78rem;
      }

      .brand-mark {
        width: 34px;
        height: 34px;
        border-radius: 10px;
        background: var(--brand-deep);
        color: #fff;
        display: grid;
        place-items: center;
        font-weight: 700;
        font-size: 0.85rem;
        box-shadow: 0 10px 20px var(--brand-fade);
      }

      .brand-subtitle {
        font-size: 0.9rem;
        color: var(--muted);
      }

      h1 {
        font-family: "Fraunces", "Iowan Old Style", "Palatino", serif;
        font-weight: 700;
        font-size: clamp(2.5rem, 5vw, 4.1rem);
        margin: 0;
      }

      .hero {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
        gap: 24px;
        align-items: center;
      }

      .hero p {
        font-size: 1.05rem;
        line-height: 1.6;
        color: var(--muted);
      }

      .cta-row {
        display: flex;
        gap: 12px;
        flex-wrap: wrap;
      }

      .cta {
        background: var(--accent);
        color: #fff;
        text-decoration: none;
        padding: 12px 18px;
        border-radius: 12px;
        font-weight: 600;
        transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
        box-shadow: 0 12px 24px rgba(198, 86, 42, 0.22);
      }

      .cta:hover {
        transform: translateY(-2px);
        background: var(--accent-dark);
      }

      .ghost {
        border: 2px solid var(--ink);
        color: var(--ink);
        background: transparent;
        box-shadow: none;
      }

      main {
        max-width: 1100px;
        margin: 0 auto;
        padding: 24px;
        display: grid;
        gap: 24px;
      }

      .card-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
        gap: 18px;
      }

      .card {
        background: var(--card);
        border: 1px solid var(--stroke);
        border-radius: 18px;
        padding: 18px;
        display: grid;
        gap: 12px;
        min-height: 180px;
        position: relative;
        overflow: hidden;
      }

      .card::after {
        content: "";
        position: absolute;
        right: -40px;
        top: -40px;
        width: 120px;
        height: 120px;
        background: rgba(198, 86, 42, 0.14);
        border-radius: 999px;
      }

      .card h3 {
        margin: 0;
        font-size: 1.2rem;
      }

      .card p {
        margin: 0;
        color: var(--muted);
        line-height: 1.5;
      }

      .card a {
        text-decoration: none;
        font-weight: 600;
        color: var(--ink);
        display: inline-flex;
        gap: 6px;
        align-items: center;
      }

      .card a span {
        display: inline-block;
        transition: transform 0.2s ease;
      }

      .card a:hover span {
        transform: translateX(4px);
      }

      .list {
        display: grid;
        gap: 12px;
        padding: 0;
        margin: 0;
        list-style: none;
      }

      .list li {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .data-card {
        gap: 16px;
      }

      .nav-card {
        gap: 16px;
      }

      .app-list {
        display: grid;
        gap: 14px;
      }

      .app-row {
        display: grid;
        gap: 6px;
        padding: 12px 14px;
        border-radius: 14px;
        border: 1px solid var(--stroke);
        background: #fff;
      }

      .app-row a {
        font-weight: 600;
        color: var(--ink);
        text-decoration: none;
      }

      .app-row a:hover {
        color: var(--accent-dark);
      }

      .app-row a[download]:hover {
        color: var(--accent);
      }

      .app-meta {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        color: var(--muted);
        font-size: 0.9rem;
      }

      .data-grid {
        display: grid;
        gap: 16px;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      }

      .data-block {
        background: #fff;
        border: 1px solid var(--stroke);
        border-radius: 14px;
        padding: 14px;
        display: grid;
        gap: 10px;
      }

      .data-block h4 {
        margin: 0;
        font-size: 1rem;
      }

      .checkboxes {
        display: grid;
        gap: 8px;
      }

      .checkboxes label {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 0.95rem;
      }

      .button {
        border: 1px solid var(--stroke);
        background: #fff;
        padding: 10px 14px;
        border-radius: 12px;
        cursor: pointer;
        font-weight: 600;
      }

      .button.primary {
        background: var(--accent);
        border-color: var(--accent);
        color: #fff;
      }

      .button.ghost {
        background: transparent;
        border-color: var(--ink);
        color: var(--ink);
      }

      .button.danger {
        background: var(--danger);
        border-color: var(--danger);
        color: #fff;
      }

      .file-input {
        border: 1px dashed var(--stroke);
        border-radius: 12px;
        padding: 10px;
        background: #fff;
      }

      .muted {
        color: var(--muted);
        font-size: 0.9rem;
      }

      .data-status {
        background: #fff;
        border: 1px solid var(--stroke);
        border-radius: 12px;
        padding: 10px 12px;
        color: var(--muted);
        font-size: 0.9rem;
      }

      dialog {
        border: none;
        border-radius: 16px;
        padding: 0;
        width: min(520px, 92vw);
        box-shadow: 0 20px 40px rgba(28, 28, 28, 0.25);
      }

      dialog::backdrop {
        background: rgba(28, 28, 28, 0.35);
      }

      .confirm-form {
        padding: 18px;
        display: grid;
        gap: 10px;
      }

      .confirm-form h3 {
        margin: 0;
        font-size: 1.1rem;
      }

      .confirm-form p {
        margin: 0;
        color: var(--muted);
        line-height: 1.5;
      }

      .confirm-actions {
        display: flex;
        justify-content: flex-end;
        gap: 10px;
      }

      .confirm-actions button {
        border: 1px solid var(--stroke);
        background: #fff;
        padding: 8px 14px;
        border-radius: 10px;
        cursor: pointer;
        font-weight: 600;
      }

      .confirm-actions .primary {
        background: var(--danger);
        border-color: var(--danger);
        color: #fff;
      }

      .dot {
        width: 10px;
        height: 10px;
        border-radius: 50%;
        background: var(--accent);
      }

      footer {
        text-align: center;
        color: var(--muted);
        padding: 24px;
        font-size: 0.9rem;
      }

      footer a {
        color: inherit;
        text-decoration: none;
        font-weight: 600;
      }

      @media (max-width: 720px) {
        header {
          padding-top: 32px;
        }

        .cta-row {
          flex-direction: column;
          align-items: stretch;
        }
      }
    </style>
  </head>
  <body>
    <header>
      <div class="brand-bar">
        <a class="brand-link" href="https://www.mcindi.com" target="_blank" rel="noopener">
          <span class="brand-mark">M</span>
          McIndi Solutions
        </a>
        <div class="brand-subtitle">WebUtils â€¢ Offline-ready utilities</div>
      </div>
      <div class="hero">
        <div>
          <h1>Focused, mission-ready web utilities in a single file.</h1>
          <p>
            McIndi WebUtils is a collection of offline-friendly tools for everyday computing.
            Each utility ships as a single HTML file so it is portable, fast, and easy to drop
            anywhere.
          </p>
          <div class="cta-row">
            <a class="cta" href="#app-nav">Browse utilities</a>
            <a class="cta ghost" href="https://www.mcindi.com" target="_blank" rel="noopener">
              Visit McIndi.com
            </a>
          </div>
        </div>
        <ul class="list">
          <li><span class="dot"></span>Zero-install, no build step.</li>
          <li><span class="dot"></span>Save data locally in your browser.</li>
          <li><span class="dot"></span>Designed for quick, focused work.</li>
        </ul>
      </div>
    </header>

    <main id="about">
      <section class="card nav-card" id="app-nav">
        <h3>Utilities</h3>
        <p class="muted">Jump into an app and see how much data it currently stores.</p>
        <div class="app-list" id="app-list"></div>
      </section>

      <section class="card data-card" id="data-controls">
        <h3>Data controls</h3>
        <p class="muted">
          Backup, restore, or reset saved data across WebUtils apps. Destructive actions
          require confirmation.
        </p>
        <div class="data-grid">
          <div class="data-block">
            <h4>Export snapshot</h4>
            <div id="export-list" class="checkboxes"></div>
            <button class="button primary" id="export-button" type="button">Export selected</button>
          </div>
          <div class="data-block">
            <h4>Restore snapshot</h4>
            <input
              class="file-input"
              id="import-file"
              type="file"
              accept=".json,application/json"
            />
            <button class="button ghost" id="import-button" type="button">Import snapshot</button>
            <small class="muted">Importing overwrites data for matching apps.</small>
          </div>
          <div class="data-block">
            <h4>Clear all data</h4>
            <p class="muted">Removes saved data for every app in this collection.</p>
            <button class="button danger" id="clear-all" type="button">Clear all app data</button>
          </div>
        </div>
        <div class="data-status" id="data-status">No data actions yet.</div>
      </section>
    </main>

    <dialog id="confirm-dialog">
      <form method="dialog" class="confirm-form">
        <h3 id="confirm-title">Confirm action</h3>
        <p id="confirm-message">Are you sure you want to continue?</p>
        <div class="confirm-actions">
          <button value="cancel" type="submit">Cancel</button>
          <button value="confirm" type="submit" class="primary" id="confirm-accept">
            Confirm
          </button>
        </div>
      </form>
    </dialog>

    <footer>
      Made for quick, quiet productivity. Built by
      <a href="https://www.mcindi.com" target="_blank" rel="noopener">McIndi Solutions LLC</a>.
    </footer>
    <script>
      const APP_REGISTRY = [
        {
          id: "kanban",
          label: "Kanban task board",
          key: "webutils.kanban.v1",
          href: "kanban.html",
          description: "Plan work with lanes, cards, and editable notes.",
        },
        {
          id: "zip-workbench",
          label: "Zip Workbench",
          key: "webutils.zip-workbench.v1",
          href: "zip-workbench.html",
          description: "Browse, edit, and re-download ZIP contents.",
        },
        {
          id: "repo2prompt",
          label: "Repo2Prompt",
          key: "webutils.repo2prompt.v1",
          href: "repo2prompt.html",
          description: "Fetch a repo ZIP and assemble a prompt-ready payload.",
        },
        {
          id: "regex-workbench",
          label: "Regex Workbench",
          key: "webutils.regex-workbench.v1",
          href: "regex-workbench.html",
          description: "Test and save regex patterns with live highlighting.",
        },
        {
          id: "notes",
          label: "Notes Wiki",
          key: "webutils.notes.v1",
          href: "notes.html",
          description: "Write Markdown notes with CamelCase links.",
        },
      ];

      const appList = document.getElementById("app-list");
      const exportList = document.getElementById("export-list");
      const exportButton = document.getElementById("export-button");
      const importFile = document.getElementById("import-file");
      const importButton = document.getElementById("import-button");
      const clearAllButton = document.getElementById("clear-all");
      const dataStatus = document.getElementById("data-status");

      const confirmDialog = document.getElementById("confirm-dialog");
      const confirmTitle = document.getElementById("confirm-title");
      const confirmMessage = document.getElementById("confirm-message");
      const confirmAccept = document.getElementById("confirm-accept");
      let confirmResolve = null;

      const requestConfirmation = ({ title, message, confirmText }) => {
        if (!confirmDialog || typeof confirmDialog.showModal !== "function") {
          return Promise.resolve(window.confirm(message || title));
        }
        confirmTitle.textContent = title;
        confirmMessage.textContent = message;
        confirmAccept.textContent = confirmText || "Confirm";
        return new Promise((resolve) => {
          confirmResolve = resolve;
          confirmDialog.showModal();
        });
      };

      confirmDialog.addEventListener("close", () => {
        if (!confirmResolve) {
          return;
        }
        const confirmed = confirmDialog.returnValue === "confirm";
        confirmResolve(confirmed);
        confirmResolve = null;
      });

      const setStatus = (text) => {
        dataStatus.textContent = text;
      };

      const formatBytes = (bytes) => {
        if (bytes <= 0) {
          return "0 B";
        }
        const units = ["B", "KB", "MB", "GB"];
        const index = Math.min(Math.floor(Math.log(bytes) / Math.log(1024)), units.length - 1);
        const value = bytes / 1024 ** index;
        return `${value.toFixed(value >= 10 || index === 0 ? 0 : 1)} ${units[index]}`;
      };

      const estimateStoredBytes = (value) => {
        if (!value) {
          return 0;
        }
        return new TextEncoder().encode(value).length;
      };

      const renderAppNav = () => {
        appList.innerHTML = "";
        APP_REGISTRY.forEach((app) => {
          const row = document.createElement("div");
          row.className = "app-row";

          const link = document.createElement("a");
          link.href = app.href;
          link.textContent = app.label;

          const downloadLink = document.createElement("a");
          downloadLink.href = app.href;
          downloadLink.download = app.href;
          downloadLink.textContent = "Download";
          downloadLink.style.fontSize = "0.85rem";
          downloadLink.style.color = "var(--muted)";
          downloadLink.style.marginLeft = "auto";

          const description = document.createElement("div");
          description.textContent = app.description;

          const storedValue = localStorage.getItem(app.key);
          const bytes = estimateStoredBytes(storedValue);
          const meta = document.createElement("div");
          meta.className = "app-meta";
          meta.textContent = storedValue ? `Stored data: ${formatBytes(bytes)}` : "No data saved";

          const topRow = document.createElement("div");
          topRow.style.display = "flex";
          topRow.style.gap = "12px";
          topRow.style.alignItems = "center";
          topRow.append(link, downloadLink);

          row.append(topRow, description, meta);
          appList.appendChild(row);
        });
      };

      const renderExportList = () => {
        exportList.innerHTML = "";
        APP_REGISTRY.forEach((app) => {
          const label = document.createElement("label");
          const checkbox = document.createElement("input");
          checkbox.type = "checkbox";
          checkbox.value = app.id;
          checkbox.checked = true;
          label.append(checkbox, document.createTextNode(app.label));
          exportList.appendChild(label);
        });
      };

      const buildSnapshot = (selectedIds) => {
        const snapshot = {
          version: 1,
          createdAt: new Date().toISOString(),
          apps: {},
        };

        APP_REGISTRY.forEach((app) => {
          if (!selectedIds.has(app.id)) {
            return;
          }
          const value = localStorage.getItem(app.key);
          if (value !== null) {
            snapshot.apps[app.id] = { key: app.key, value };
          }
        });

        return snapshot;
      };

      const downloadSnapshot = (snapshot) => {
        const blob = new Blob([JSON.stringify(snapshot, null, 2)], {
          type: "application/json",
        });
        const url = URL.createObjectURL(blob);
        const link = document.createElement("a");
        const timestamp = new Date().toISOString().replace(/[:.]/g, "-");
        link.href = url;
        link.download = `webutils-snapshot-${timestamp}.json`;
        document.body.appendChild(link);
        link.click();
        link.remove();
        URL.revokeObjectURL(url);
      };

      exportButton.addEventListener("click", () => {
        const selected = new Set(
          Array.from(exportList.querySelectorAll("input[type='checkbox']"))
            .filter((checkbox) => checkbox.checked)
            .map((checkbox) => checkbox.value)
        );

        if (selected.size === 0) {
          setStatus("Select at least one app to export.");
          return;
        }

        try {
          const snapshot = buildSnapshot(selected);
          const count = Object.keys(snapshot.apps).length;
          if (count === 0) {
            setStatus("No saved data found for the selected apps.");
            return;
          }
          downloadSnapshot(snapshot);
          setStatus(`Exported ${count} app data sets.`);
        } catch (error) {
          setStatus("Export failed. Check browser storage permissions.");
        }
      });

      importButton.addEventListener("click", async () => {
        const file = importFile.files[0];
        if (!file) {
          setStatus("Choose a snapshot file to import.");
          return;
        }

        const confirmed = await requestConfirmation({
          title: "Import snapshot?",
          message: "This will overwrite saved data for apps included in the snapshot.",
          confirmText: "Import",
        });

        if (!confirmed) {
          return;
        }

        try {
          const text = await file.text();
          const snapshot = JSON.parse(text);
          if (!snapshot || typeof snapshot !== "object" || !snapshot.apps) {
            setStatus("Snapshot format not recognized.");
            return;
          }

          let restored = 0;
          APP_REGISTRY.forEach((app) => {
            const entry = snapshot.apps[app.id];
            if (entry && typeof entry.value === "string") {
              localStorage.setItem(app.key, entry.value);
              restored += 1;
            }
          });

          setStatus(`Imported data for ${restored} app(s).`);
        } catch (error) {
          setStatus("Import failed. The file may be invalid.");
        } finally {
          importFile.value = "";
        }
      });

      clearAllButton.addEventListener("click", async () => {
        const confirmed = await requestConfirmation({
          title: "Clear all app data?",
          message: "This removes saved data for every app in WebUtils.",
          confirmText: "Clear all",
        });
        if (!confirmed) {
          return;
        }

        APP_REGISTRY.forEach((app) => localStorage.removeItem(app.key));
        setStatus("Cleared all saved app data.");
        renderAppNav();
      });

      renderExportList();
      renderAppNav();
    </script>
  </body>
</html>
